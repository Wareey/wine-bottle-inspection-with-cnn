个人课程作业,使用的方法比较麻烦,代码屎山,效果也不是很好,仅供参考
如愿意交流指导,不胜感激

python 11.7
cuda 12.4
根据官网提示，安装对应pytorch

数据集引用
@misc{
        title={瓶装白酒疵品检测数据集}
        url={https://tianchi.aliyun.com/dataset/dataDetail?dataId=110147}
        author={Tianchi},
        year={2021}
}
具体协议见网页链接

BeiYeSi.py用贝叶斯优化来训练单个模型,寻找超参数
train.py用来训练多个模型,整合结果
test.py简单统计数据集的内容
model1.py可以网格搜索单个模型最优超参数,使用有点麻烦,代码有点石山,感觉可以用递归优化一下函数
DataSplit.py用来分割数据集,先按大小分两类,再将数据集分为训练集,测试集和验证集
ImagesDataset.py用来加载图片

数据集分析:
1.3000*4096为标签图,492*658为瓶盖图
2.一张标签图  可以对应3种类型标签瑕疵

如果直接分类训练可能准确率较低,故对数据集图片按大小先行分类,

再训练10个卷积模型进行二分类,即判断图片是否存在该类型瑕疵,最后将结果整合

A数据集
图片,1瑕疵有无
图片,2瑕疵有无
图片,3瑕疵有无
...

B数据集训练时
图片,6瑕疵有无
图片,7瑕疵有无
图片,8瑕疵有无

